P1805_HW3_kp2809
================
Kimberly Lopez
2024-10-07

Loading Data

``` r
nrow(ny_noaa)
```

    ## [1] 2595176

The ny_noaa data set has 7 columns and 2.5 million row entries which
detail the id, date of observed data, and precipitation (tenths of mm),
snow (mm), snow depth (mm), temperature max(tenths of degrees C), and
temperature min (tenths of degrees C). Id being Weather station ID
name.There is some missing data in columns for precipitation, snwd,
tempertaure max and min.

Do some data cleaning. Create separate variables for year, month, and
day. Ensure observations for temperature, precipitation, and snowfall
are given in reasonable units. For snowfall, what are the most commonly
observed values? Why?

- date has year, month, and day. Need to pivot wider and save into 3 new
  columns

``` r
ny_noaa = 
  ny_noaa |>
  separate(date, into = c("year", "month", "day"), convert = TRUE) |> 
  mutate(
    tmax = as.numeric(tmax),
    tmin = as.numeric(tmin))
```

``` r
ny_noaa |> 
  select(snow)|>
  drop_na()|>
  pull(snow)|> 
  range()
```

    ## [1]   -13 10160

The range of snow fall is -13 to 10,160.

*Temperature*

The range of temperature is -1-99 which could be in F rather than
Celcius.

The range for precipitation is 22860 which leads me to think they are
not in the same units. There appears to be 4 outliers in reported
snowfall which might be calculated in different units. Make a two-panel
plot showing the average max temperature in January and in July in each
station across years. Is there any observable / interpretable structure?
Any outliers?

``` r
ny_noaa |> 
  group_by(id, year, month) |> 
  filter(month %in% c(1, 7)) |> 
  summarize(mean_tmax = mean(tmax, na.rm = TRUE, color = id)) |> 
  ggplot(aes(x = year, y = mean_tmax, group = id)) + 
  geom_point() + 
  geom_path() +
  facet_grid(~month) +
  labs(title = "Average monthly temperature for each station across years for January and July")
```

    ## `summarise()` has grouped output by 'id', 'year'. You can override using the
    ## `.groups` argument.

    ## Warning: Removed 5970 rows containing missing values or values outside the scale range
    ## (`geom_point()`).

    ## Warning: Removed 5931 rows containing missing values or values outside the scale range
    ## (`geom_path()`).

![](P1805_HW3_kp2809_files/figure-gfm/unnamed-chunk-8-1.png)<!-- -->

Make a two-panel plot showing (i) tmax vs tmin for the full dataset
(note that a scatterplot may not be the best option); and (ii) make a
plot showing the distribution of snowfall values greater than 0 and less
than 100 separately by year.

``` r
hex = 
  ny_noaa |>
  ggplot(aes(x = tmin, y = tmax)) + 
  geom_hex()
hex
```

    ## Warning: Removed 1136276 rows containing non-finite outside the scale range
    ## (`stat_binhex()`).

![](P1805_HW3_kp2809_files/figure-gfm/unnamed-chunk-9-1.png)<!-- -->

``` r
ridge = 
  ny_noaa |>
  filter(snow < 100, snow > 0) |>
  ggplot(aes(x = snow, y = as.factor(year))) + 
  geom_density_ridges()

hex + ridge
```

    ## Warning: Removed 1136276 rows containing non-finite outside the scale range
    ## (`stat_binhex()`).

    ## Picking joint bandwidth of 3.76

![](P1805_HW3_kp2809_files/figure-gfm/unnamed-chunk-10-1.png)<!-- -->

# Problem 2

Load, tidy, merge, and otherwise organize the data sets. Your final
dataset should include all originally observed variables;

- exclude participants less than 21 years of age, and those with missing
  demographic data
- Might need to pivot longer saving all min1 times to a column of
  minute_day and saving the values to a column of phys_activity for each
  of those times
- encode data with reasonable variable classes (i.e. not numeric, and
  using factors with the ordering of tables and plots in mind).

``` r
nhanes_accel = read_csv("data/nhanes_accel.csv",na = c("NA","","."))
```

    ## Rows: 250 Columns: 1441
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (1441): SEQN, min1, min2, min3, min4, min5, min6, min7, min8, min9, min1...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
nhanes_covar = read_csv("data/nhanes_covar.csv", na = c("NA","","."), skip =4)
```

    ## Rows: 250 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (5): SEQN, sex, age, BMI, education
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
nhanes_df = 
  inner_join(nhanes_accel, nhanes_covar, by= "SEQN")|>
  janitor::clean_names()|>
  relocate(seqn, sex, age, bmi, education)|>
  filter(age >=21)|>
  drop_na(bmi,education)

nhanes_df
```

    ## # A tibble: 228 × 1,445
    ##     seqn   sex   age   bmi education  min1   min2   min3  min4   min5   min6
    ##    <dbl> <dbl> <dbl> <dbl>     <dbl> <dbl>  <dbl>  <dbl> <dbl>  <dbl>  <dbl>
    ##  1 62161     1    22  23.3         2 1.11  3.12   1.47   0.938 1.60   0.145 
    ##  2 62164     2    44  23.2         3 1.92  1.67   2.38   0.935 2.59   5.22  
    ##  3 62169     1    21  20.1         2 5.85  5.18   4.76   6.48  6.85   7.24  
    ##  4 62174     1    80  33.9         3 5.42  3.48   3.72   3.81  6.85   4.45  
    ##  5 62177     1    51  20.1         2 6.14  8.06   9.99   6.60  4.57   2.78  
    ##  6 62178     1    80  28.5         2 0.167 0.429  0.131  1.20  0.0796 0.0487
    ##  7 62180     1    35  27.9         3 0.039 0      0      0     0.369  0.265 
    ##  8 62184     1    26  22.1         2 1.55  2.81   3.86   4.76  6.10   7.61  
    ##  9 62189     2    30  22.4         3 2.81  0.195  0.163  0     0.144  0.180 
    ## 10 62199     1    57  28           3 0.031 0.0359 0.0387 0.079 0.109  0.262 
    ## # ℹ 218 more rows
    ## # ℹ 1,434 more variables: min7 <dbl>, min8 <dbl>, min9 <dbl>, min10 <dbl>,
    ## #   min11 <dbl>, min12 <dbl>, min13 <dbl>, min14 <dbl>, min15 <dbl>,
    ## #   min16 <dbl>, min17 <dbl>, min18 <dbl>, min19 <dbl>, min20 <dbl>,
    ## #   min21 <dbl>, min22 <dbl>, min23 <dbl>, min24 <dbl>, min25 <dbl>,
    ## #   min26 <dbl>, min27 <dbl>, min28 <dbl>, min29 <dbl>, min30 <dbl>,
    ## #   min31 <dbl>, min32 <dbl>, min33 <dbl>, min34 <dbl>, min35 <dbl>, …

Produce a reader-friendly table for the number of men and women in each
education category, and create a visualization of the age distributions
for men and women in each education category. Comment on these items.

- 1= male, 2= female
- 2 rows men or women
- 3 columns sex, education level 1, 2, 3

``` r
nhanes_df |>
  select(sex, education) |>
  table() |>
  knitr::kable(col.names = c("Less than HS", "HS Equivalent", "More than HS"))
```

| Less than HS | HS Equivalent | More than HS |
|-------------:|--------------:|-------------:|
|           27 |            35 |           56 |
|           28 |            23 |           59 |

This table shows us there are 27 males with less than a HS education, 35
with HS equivalent education, and 56 with more than a HS level
education. It also shows 28 females with less than HS, 23 with HS
equivalent level of education, and 59 with more than a HS level
education in this sample.

Aggregate across minutes to create a total activity variable for each
participant.

``` r
nhanes_accel = read_csv("data/nhanes_accel.csv",na = c("NA","","."))
```

    ## Rows: 250 Columns: 1441
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (1441): SEQN, min1, min2, min3, min4, min5, min6, min7, min8, min9, min1...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
nhanes_covar = read_csv("data/nhanes_covar.csv", na = c("NA","","."), skip =4)
```

    ## Rows: 250 Columns: 5
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (5): SEQN, sex, age, BMI, education
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
nhanes_df = 
  inner_join(nhanes_accel, nhanes_covar, by= "SEQN")|>
  janitor::clean_names()|>
  relocate(seqn, sex, age, bmi, education)|>
  filter(age >=21)|>
  drop_na(bmi,education)|>
  pivot_longer(
    cols= min1:min1440,
    names_to = "minute_day", 
    names_prefix = "min",
    values_to= "phys_activ"
  )|>
  mutate(
    minute_day = as.numeric(minute_day)
  )

nhanes_df
```

    ## # A tibble: 328,320 × 7
    ##     seqn   sex   age   bmi education minute_day phys_activ
    ##    <dbl> <dbl> <dbl> <dbl>     <dbl>      <dbl>      <dbl>
    ##  1 62161     1    22  23.3         2          1      1.11 
    ##  2 62161     1    22  23.3         2          2      3.12 
    ##  3 62161     1    22  23.3         2          3      1.47 
    ##  4 62161     1    22  23.3         2          4      0.938
    ##  5 62161     1    22  23.3         2          5      1.60 
    ##  6 62161     1    22  23.3         2          6      0.145
    ##  7 62161     1    22  23.3         2          7      2.10 
    ##  8 62161     1    22  23.3         2          8      0.509
    ##  9 62161     1    22  23.3         2          9      1.63 
    ## 10 62161     1    22  23.3         2         10      1.20 
    ## # ℹ 328,310 more rows

Plot these total activities (y-axis) against age (x-axis); your plot
should compare men to women and have separate panels for each education
level. Include a trend line or a smooth to illustrate differences.
Comment on your plot.

- group by sex
