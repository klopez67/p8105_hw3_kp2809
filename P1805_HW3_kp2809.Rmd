---
title: "P1805_HW3_kp2809"
author: "Kimberly Lopez"
date: "2024-10-07"
output: github_document
---
Loading Data 
```{r include=FALSE}
library(tidyverse)
library(haven)
library(p8105.datasets)
data(ny_noaa)

```

The ny_noaa data set has 7 columns and 2.5 million row entries which detail the id, date of observed data, and precipitation (tenths of mm), snow (mm), snow depth (mm), temperature max(tenths of degrees C), and temperature min (tenths of degrees C). Id being Weather station ID name.There is some missing data in columns for precipitation, snwd, tempertaure max and min. 


Do some data cleaning. Create separate variables for year, month, and day. Ensure observations for temperature, precipitation, and snowfall are given in reasonable units. For snowfall, what are the most commonly observed values? Why?

- date has year, month, and day. Need to pivot wider and save into 3 new columns 

```{r eval=FALSE, include=FALSE}
ny_noaa |> 
  mutate(year = format(date, "%Y"),
         month = format(date, "%m"),
         day = format(date, "%d"))|> 
  relocate(id, date, year, month,day)

```
```{r eval=FALSE, include=FALSE}
ny_noaa |> 
  select(snow)|>
  drop_na()|>
  pull(snow)|> 
  range()
```
The range of snow fall is -13 to 10,160. 

```{r eval=FALSE, include=FALSE}
ny_noaa|>
  ggplot(aes(x= id,y = snow)) + 
  geom_point()
```
*Precipitation * 
```{r eval=FALSE, include=FALSE}
ny_noaa |> 
  select(prcp)|>
  drop_na()|> 
  pull(prcp)|>
  range()
```
Precipitation typically falls between 0 to 500 mm, so some of these values need to be converted. 

*Temperature* 
```{r eval=FALSE, include=FALSE}
ny_noaa |> 
  select(tmax)|>
  drop_na()|> 
  pull(tmax)|>
  range()

```
The range of temperature is -1-99 which could be in F rather than Celcius. 

```{r eval=FALSE, include=FALSE}
ny_noaa|>
  ggplot(aes(x= id,y = prcp)) + 
  geom_point()
```

The range for precipitation is 22860 which leads me to think they are not in the same units. 


There appears to be 4 outliers in reported snowfall which might be calculated in different units. 

Make a two-panel plot showing the average max temperature in January and in July in each station across years. Is there any observable / interpretable structure? Any outliers?

Make a two-panel plot showing (i) tmax vs tmin for the full dataset (note that a scatterplot may not be the best option); and (ii) make a plot showing the distribution of snowfall values greater than 0 and less than 100 separately by year.


# Problem 2 

Load, tidy, merge, and otherwise organize the data sets. Your final dataset should include all originally observed variables; 

- exclude participants less than 21 years of age, and those with missing demographic data
- encode data with reasonable variable classes (i.e. not numeric, and using factors with the ordering of tables and plots in mind).

```{r}
nhanes_accel = read_csv("data/nhanes_accel.csv",na = c("NA","","."))
nhanes_covar = read_csv("data/nhanes_covar.csv", na = c("NA","","."), skip =4)

nhanes_df = 
  inner_join(nhanes_accel, nhanes_covar, by= "SEQN")|>
  janitor::clean_names()|>
  relocate(seqn, sex, age, bmi, education)|>
  filter(age >=21)|>
  drop_na(bmi,education)|>
  pivot_longer(
    cols= min1:min1440,
    names_to = "minute_day", 
    names_prefix = "min",
    values_to= "phys_activ"
  )

nhanes_df
```
**Might need to pivot longer saving all min1 times to a column of minute_day and saving the values to a column of phys_activity for each of those times
